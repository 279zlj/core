<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:r="http://schemas.openxmlformats.org/package/2006/relationships"
                xmlns:mainr="http://schemas.openxmlformats.org/officeDocument/2006/relationships"
                xmlns:main="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
                xmlns:msxsl="urn:schemas-microsoft-com:xslt"
                xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"
                extension-element-prefixes="msxsl">

	<xsl:template name="index_file">
		<file name="{$workbook_filename}">
			<html xmlns="http://www.w3.org/TR/REC-html40">
				<head>
					<meta http-equiv="Content-Type" content="text/html; charset={$charset}"/>
					<xsl:for-each select="$worksheets_info/sheet">
						<link id="shLink">
							<xsl:attribute name="href">
								<xsl:value-of select="@file_path"/>
							</xsl:attribute>
						</link>
					</xsl:for-each>
					<link id="shLink"/>
				</head>
				<frameset rows="*,39" border="0" width="0" frameborder="no" framespacing="0">
					<frame>
						<xsl:attribute name="src">
							<xsl:value-of select="$workbook_name"/>
							<xsl:text>_files/sheet001.htm</xsl:text>
						</xsl:attribute>
						<xsl:attribute name="name">frSheet</xsl:attribute>
					</frame>
					<frame>
						<xsl:attribute name="src">
							<xsl:value-of select="$workbook_name"/>
							<xsl:text>_files/tabs.htm</xsl:text>
						</xsl:attribute>
						<xsl:attribute name="name">frSheet_tabs</xsl:attribute>
						<xsl:attribute name="marginwidth">0</xsl:attribute>
						<xsl:attribute name="marginheight">0</xsl:attribute>
					</frame>
					<noframes>
						<body>
							<p>This page uses frames, but your browser doesn't support them.</p>
						</body>
					</noframes>
				</frameset>
			</html>
		</file>
	</xsl:template>

  <xsl:template name="single_index_file">
    <file name="{$workbook_filename}">
      <html xmlns="http://www.w3.org/TR/REC-html40">

        <head>
          <meta http-equiv="Content-Type" content="text/html; charset={$charset}"/>
          <style>
            <xsl:comment>
              <xsl:call-template name="css_content"/>
			  <xsl:text>
.noPrint {
	-moz-background-clip:border;
	-moz-background-inline-policy:continuous;
	-moz-background-origin:padding;
	background:#F0F0F0 none repeat scroll 0 0;
	border:4px solid #CCCCCC;
}
.header {
	height:45px;
	padding:0 8px;
	vertical-align:center;
}
body {
	margin:0;
	padding:0;
}
.button {
	vertical-align:middle;
}
h3 {
	font-family:Arial,Helvetica,sans-serif;
	font-size:12pt;
	margin-top:10px;
}
@media print {	 
   .noPrint {display:none;visibility:hidden;} 	
}
			  </xsl:text>				
            </xsl:comment>
		  </style>
			<xsl:choose>
				<xsl:when test="$print_file = 'true'">
					<title>
						<xsl:value-of select="$workbook_name"/>
						<xsl:text> - </xsl:text>
						<xsl:value-of select="$worksheets_info/sheet[position() = $print_index]/@name"/>
					</title>
					<script type="text/javascript">window.print();</script>
				</xsl:when>
			</xsl:choose>
		</head>
        <body link="blue" vlink="purple" onload="OnLoad();">
			<xsl:choose>
				<xsl:when test="$print_file = 'true'">
					<div style="width:100%;top:-60px;">
						<table width="100%" cellspacing="0" cellpadding="0" class="noPrint">
							<tr>
								<td class="header">
									<table width="100%" height="100%" cellspacing="0" cellpadding="0">
										<tr>
											<td>
												<h3>
													<xsl:value-of select="$workbook_name"/>
												</h3>
											</td>
											<td align="right" class="button">
												<input type="button" name="Print"  value="Печать" onClick="print();"/>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</div>
					<div style="position: absolute; top: 60px; margin-left: 5px;">
						<xsl:for-each select="$worksheets_files/main:worksheet[position() = $print_index]">
							<xsl:variable name="ws_pos" select="$print_index"/>
							<xsl:call-template name="sheet_body_content"/>
						</xsl:for-each>
					</div>
				</xsl:when>
				<xsl:otherwise>
					<xsl:for-each select="$worksheets_files/main:worksheet">
						<xsl:variable name="ws_pos" select="position()"/>
						<div>
							<h2>
								<xsl:text>Sheet: </xsl:text>
								<xsl:value-of select="$worksheets_info/sheet[position() = $ws_pos]/@name"/>
							</h2>
						</div>
						<div>
							<xsl:call-template name="sheet_body_content"/>
						</div>
						<div>
							<hr/>
						</div>
					</xsl:for-each>
				</xsl:otherwise>
			</xsl:choose>
        </body>
      </html>
    </file>
  </xsl:template>

</xsl:stylesheet>
